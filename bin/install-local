#!/usr/bin/env sh


env_path=config/app.env
yml_path=config/app.yml

default_db_url="mongodb://localhost:27017/mass-labeling"
default_port=80


read -p "Enter MongoDB URL ($default_db_url): " db_url
read -p "Enter server port ($default_port): " port
read -p "Enter cookie secret: " cookie_secret
echo ""

if [ -z "$db_url" ]; then
  db_url="$default_db_url"
fi

if [ -z "$port" ]; then
  port="$default_port"
fi


if [ -f "$env_path" ]; then
  echo "Backup $env_path to $env_path.bak"
  mv "$env_path" "$env_path.bak"
fi

echo "Save $env_path"
touch "$env_path"
echo "DB_URL=$db_url" >> "$env_path"
echo "PORT=$port" >> "$env_path"
echo "COOKIE_SECRET=$cookie_secret" >> "$env_path"


if [ -f "$yml_path" ]; then
  echo "Backup $yml_path to $yml_path.bak"
  mv "$yml_path" "$yml_path.bak"
fi

echo "Save $yml_path"
touch "$yml_path"
echo "{}" >> "$yml_path"
